<form class="p-4" [formGroup]="categoryForm" (ngSubmit)="onSubmit()">
  <div
    class="flex items-center gap-4 mb-3 rounded-xl w-fit transition-all hover:border-blue-300 group"
  >
    <div class="relative group">
      <button
        type="button"
        (click)="op.toggle($event)"
        aria-label="Open emoji picker"
        class="w-14 h-14 flex items-center justify-center bg-white border-2 border-gray-100 rounded-2xl shadow-sm transition-all duration-200 hover:scale-105 hover:border-blue-400 hover:shadow-md active:scale-95 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
      >
        <ngx-emoji [emoji]="selectedIcon()" [size]="32" class="leading-none"></ngx-emoji>

        <div
          class="absolute -bottom-1 -right-1 flex items-center p-0.5 justify-center bg-blue-600 text-white rounded-full aspect-square shadow-sm opacity-0 group-hover:opacity-100 transition-opacity"
        >
          <ng-icon name="lucidePlus" size="12"></ng-icon>
        </div>
      </button>
    </div>

    <div class="flex flex-col">
      <span class="text-sm font-semibold text-slate-800 tracking-tight">Emoji Icon</span>
      <p class="text-xs text-slate-500 font-medium">Click to pick an emoji icon</p>
    </div>
  </div>

  <p-popover #op>
    <emoji-mart
      title="Pick your emojiâ€¦"
      emoji="point_up"
      (emojiClick)="addEmoji($event)"
    ></emoji-mart>
  </p-popover>

  <app-form-input
    id="name"
    label="Category Name"
    placeholder="e.g., Salary, Groceries, Bonus"
    formControlName="name"
  />

  <app-form-input
    id="type"
    label="Category Type"
    placeholder="Select category type"
    [isSelect]="true"
    [options]="categoryTypeOptions"
    formControlName="type"
  />

  <div
    class="w-fit ml-auto"
    [pTooltip]="
      categoryForm.invalid
        ? 'Fill up form to submit'
        : isEditMode && !isDirty()
          ? 'No changes detected'
          : ''
    "
  >
    <p-button
      type="submit"
      [loading]="isLoading()"
      [unstyled]="true"
      [disabled]="categoryForm.invalid || (isEditMode && !isDirty())"
      styleClass="disabled:cursor-not-allowed disabled:grayscale-75 disabled:hover:bg-green-600/30 disabled:transition-none bg-green-600/30 hover:bg-green-600/40 text-green-600 font-medium py-2 px-4 rounded-md transition duration-300 flex items-center justify-center gap-2"
    >
      <span>{{ isEditMode ? 'Update category' : 'Add category' }}</span>
    </p-button>
  </div>
</form>
